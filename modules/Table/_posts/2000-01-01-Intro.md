# Completed CoverM Tutorial

---
title: Abundance tables
---

The mapping of reads against the co-assembly allows us to quantify the coverage of each contig in each sample (something you are very familiar with, thanks to Anvi'o). We can use **CoverM** to produce an abundance table from a set of BAM files.

## Installing CoverM

Install CoverM using conda:

```bash
# Create a new environment with CoverM
mamba create -n coverm -c bioconda coverm

# Activate the environment
mamba activate coverm

# Check installation
coverm --version
```

## Running CoverM

We have three BAM files in `bam_files/`: ERR6797443.bam, ERR6797444.bam, and ERR6797445.bam.

```bash
# Calculate coverage metrics for all contigs
coverm contig \
  -b bam_files/ERR679744*.bam \              # Input BAM files (wildcard matches all three)
  -m mean covered_fraction rpkm tpm \        # Coverage metrics to calculate
  -o abundance_table.tsv \                   # Output file name
  --exclude-supplementary \                  # Ignore supplementary alignments
  -t 8                                       # Number of threads
```

## Output File

The output is a TSV file with the following structure:

| Column | Description |
|--------|-------------|
| **Contig** | Contig identifier |
| **{Sample} Mean** | Mean coverage depth across the contig |
| **{Sample} Covered Fraction** | Proportion of contig covered by reads (0-1) |
| **{Sample} RPKM** | Reads Per Kilobase per Million mapped reads |
| **{Sample} TPM** | Transcripts Per Million (normalized abundance) |

Each sample gets one column per requested metric. In this case, with 3 samples and 4 metrics, 
you'll have **13 columns total** (1 for contig names + 3 samples Ã— 4 metrics).

**Note**: TPM values are particularly useful for comparing abundances between samples, 
as they account for both sequencing depth and contig length.