---
title: Filtering reads
---


```bash
fastp -i sample_R1.fastq -I sample_R2.fastq \
    -o sample_trimmed_R1.fastq -O sample_trimmed_R2.fastq \
    --detect_adapter_for_pe --cut_tail -q 20 -u 30 -l 50 -w 8 \
    -h fastp_report.html -j fastp_report.json
```

### A loop

```bash
# Set your input and output directory paths/names
RAW_READS=./reads/
OUTDIR=./filt-reads/

mkdir -p "$OUTDIR"/logs

for r1 in "$RAW_READS"/*_1.fastq.gz; do
    # Infer the name of R2
    r2=${r1/_1.fastq.gz/_2.fastq.gz}
    # Extract the "sample name"
    base=$(basename "$r1" _1.fastq.gz)
    
    # Check if R2 exists 
    if [[ ! -e $r2 ]]; then
        echo "Skipping $basename: R2 not found in $r2"
        continue
    fi

    # Run fastp
    fastp -i "$r1" -I "$r2" \
          -o "$OUTDIR"/${base}_1.fastq.gz \
          -O "$OUTDIR"/${base}_2.fastq.gz \
          --detect_adapter_for_pe --cut_tail -q 20 -u 30 -l 50 -w 8 \
          -h "$OUTDIR"/logs/${base}.fastp.html \
          -j "$OUTDIR"/logs/${base}.fastp.json
done
```